# B-cells-tcn
介绍：基于Bert嵌入与多阶段TCN卷积神经网络，对B细胞修饰位点的预测。

背景：
    B细胞表位的鉴定是研制疫苗、疾病诊断的关键步骤，由于构象表位很难预测，目前的研究主要集中在线性B细胞表位预测方法的开发。随着机器学习的深度发展，线性B细胞表位预测的计算方法以及相关数据库得到较快的发展，但总体预测表现尚不能令人满意，传统方法对B细胞表位预测仅单独对蛋白质序列本身预测，序列数据间可能存在冗余或特征间存在高度相关性，所以需要特征选择的方法对特征分类没有贡献的特征进行处理，再结合深度学习相关模型，以达到更好的结果。
    短文本分类是自然语言处理中一项具有挑战性的任务，目前利用外部知识处理短文本稀疏性和歧义性的传统方法取得了较好的效果，基于RNN的方法在并行化方面表现不佳，导致效率较低，基于CNN的方法可以捕捉局部特征，但由于忽略上下文相关的特征以及一词多义等问题，准确率还有待提高，针对以上问题，在本文中，我们提出基于CNN与TCN相结合，并加入权重优化与注意力机制的短文本分类模型。通过BERT训练词向量，引入词性和词语权重对词向量优化，将优化的词向量作为输入层信息，经过CNN和TCN相结合的方法提取特征，最后结合注意力机制拼接向量突显关键信息，获得文本特征表示，实验表明，与几种常用的基于CNN和RNN的短文本分类方法相比，该方法在短文本分类中更加准确高效。而生物的序列数据同样与文本数据类似，因此，我们迁移此方法用于预测生物相关序列。

结果：
    我们在Bert特征的基础上，成功构建了基于时间卷积神经网络(TCN)的模型,用来分析B细胞的氨基酸序列数据，并对其修饰位点进行预测。最终，对于测试集，预测的准确度达到了0.774，AUROC指标也达到了0.850。此模型拥有着比其他模型更好的预测效果。
    

| FILE NAME           | DESCRIPTION                                                  |
| :------------------ | :----------------------------------------------------------- |
| TCN-model-train.ipynb  | 多阶段TCN模型的构建与训练 |
| layers.py           | 已定义的注意力机制模块 |
| fea.ipynb            | 特征工程与特征组合 |
| shap.py             | 运用shap算法，对Bert的特征选择 |
| final model       | 所选择的最终模型 |
| data                | 数据相关         |
| predict.ipynb          | 运用该模型进行预测的实例           |

##安装
- Requirement
  
  OS：
  
  - `Windows` ：Windows7 or later
  
  - `Linux`：Ubuntu 16.04 LTS or later
  
  Python：
  
  - `Python` >= 3.6
  
- Download `B-cells-TCN`to your computer

  ```bash
  git clone https://github.com/LiuHeng02/B-cells-tcn.git
  ```
note：本人使用了kaggle平台的计算资源，GPU为P100，显存为16G，CPU运行内存为13G，硬件配置需求可参考此。

##运行

##1特征工程

shap文件夹中的文件，是关于bert模型的特征选择。fea.ipynb文件是关于特征工程的文件，其最终运行结果为进行特征组合且正则化后的152维特征数组。

note:本项目是已使用训练好的Bert模型，微调后对序列进行特征的提取，数据存放在BERT_feature文件夹下。如果想要对于其他序列进行研究，需要在https://github.com/google-research/bert 下载适当的Bert模型并进行训练和微调，也可以尝试专业领域内开源的Bert模型，如protern-bert，BIO-bert等。

##2模型的构建与训练

TCN-model-train.ipynb文件是关于构建模型，并训练模型。我们采用了5折交叉验证，保存的权重在mymodel2/our_model_TCN_test文件夹下，我们选择了效果最好的一次训练权重，保存在final model文件夹下。

##3预测示例

predict.ipynb文件是关于预测的代码文件，我们采用10个正样本10个负样本作为运行实列，预测结果保存在result.txt文件中。

note：如果需要对于其他数据集的序列进行预测，需要通过Bert预训练，并提取embedding特征。


